#tag WindowBegin Window wndSQLDebugging   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   656   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   1535547685   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   True   Title           =   "SQL Testing"   Visible         =   True   Width           =   633   Begin StaticText StaticText1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   30      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "SQL to try"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   22      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin EditField SQLEntry      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   173      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   29      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      Password        =   ""      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   ""      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   49      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   569   End   Begin PushButton RunSelectButton      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Select"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   30      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   266      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin EditField SQLResults      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   338      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   30      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      Password        =   ""      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   ""      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   298      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   573   End   Begin PushButton RunExecButton      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Exec"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   137      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   266      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PushButton ShowTablesButton      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Tables"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   245      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   266      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PopupMenu PrevCommands      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   55      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   234      Underline       =   ""      Visible         =   True      Width           =   543   End   Begin BevelButton AddPrevButton      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   "&c000000"      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "+"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   30      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      MenuValue       =   0      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   "&c000000"      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   234      Underline       =   False      Value           =   False      Visible         =   True      Width           =   17   EndEnd#tag EndWindow#tag WindowCode	#tag MenuHandler		Function AboutApp() As Boolean Handles AboutApp.Action			rbDBExplorerAbout.ShowModal			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function DBExec() As Boolean Handles DBExec.Action			DoExec			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function DBSaveCommand() As Boolean Handles DBSaveCommand.Action			DoAddPrev			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function DBSelect() As Boolean Handles DBSelect.Action			DoSelect			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function DBShowTables() As Boolean Handles DBShowTables.Action			DoShowTables			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileOpen() As Boolean Handles FileOpen.Action			call HandleFileOpen			Return True					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub CreateScratchDatabase()		  dim dbr as new REALSQLDatabase		  dbr.DatabaseFile = new FolderItem("SQLTestingScratch")		  If not dbr.CreateDatabaseFile then		    MsgBox "Database not created"		    Quit(1)		  end if		  self.db = dbr		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub DoAddPrev()		  dim sql as string = SQLEntry.text		  const maxMenuLen = 40		  if sql.Len > maxMenuLen then		    PrevCommands.AddRow  Left(sql, maxMenuLen-3) + "..."		  else		    PrevCommands.AddRow sql		  end if		  PrevCommands.RowTag(PrevCommands.ListCount-1) = sql  ' stuff the entire string into the RowTag		  PrevCommands.ListIndex = PrevCommands.ListCount-1		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub DoExec(sqlSource as string = "")		  		  if sqlSource.LenB = 0 then sqlSource = SQLEntry.text		  db.SQLExecute( sqlSource )		  SQLResults.text = db.ErrorMessage		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub DoSelect(sqlSource as string = "")		  if sqlSource.LenB = 0 then sqlSource = SQLEntry.text		  dim rs as RecordSet = db.SQLSelect( sqlSource )		  if rs is nil then		    if DB.ErrorCode <> 0 then		      SQLResults.text = "**** ERROR " + str(DB.ErrorCode) + " ***" + EndOfLine + db.ErrorMessage		    else		      SQLResults.text = "**** NO RESULT ***"		    end if		  else		    SQLResults.text = rs.AsTextBlock		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub DoShowTables()		  SQLResults.text = Join(DB.Tables, EndOfLine)		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Function HandleFileOpen(f as FolderItem = nil) As Boolean		  // can be called with known FolderItem		  if f is nil then		    f = GetOpenFolderItem(DatabaseFileTypes.All)		  end if		  if f is nil then return True		  		  DB = nil		  		  dim rsdDB as new REALSQLDatabase()		  rsdDB.DatabaseFile = f		  if not rsdDB.Connect then		    MsgBox "Unable to open database '" + f.ShellPath + "'"		  else		    DB = rsdDB		  end if		  return true		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub ShowSQL(sqlSource as string)		  SQLEntry.text = sqlSource		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ShowWithDatabase(useDB as Database, optionalSQL as string = "")		  Show		  self.db = useDB		  SQLEntry.text = optionalSQL		End Sub	#tag EndMethod	#tag Note, Name = About	#tag EndNote	#tag Property, Flags = &h1		Protected db As Database	#tag EndProperty#tag EndWindowCode#tag Events RunSelectButton	#tag Event		Sub Action()		  DoSelect		End Sub	#tag EndEvent#tag EndEvents#tag Events RunExecButton	#tag Event		Sub Action()		  DoExec		  		End Sub	#tag EndEvent#tag EndEvents#tag Events ShowTablesButton	#tag Event		Sub Action()		  DoShowTables		  		End Sub	#tag EndEvent#tag EndEvents#tag Events PrevCommands	#tag Event		Sub Change()		  if me.ListIndex = -1 then return		  SQLEntry.text = me.RowTag(me.ListIndex).StringValue		End Sub	#tag EndEvent#tag EndEvents#tag Events AddPrevButton	#tag Event		Sub Action()		  DoAddPrev		End Sub	#tag EndEvent#tag EndEvents